<h2><%= l(:label_revision) %> <%= @diff_format_revisions %> <%=h @path %></h2>

<!-- Choose view type -->
<%= form_tag({:action => 'diff', :id => @project,
              :repository_id => @repository.identifier_param,
              :path => to_path_param(@path), :rev=> @rev, 
              :context_lines => @context_lines, :type => @diff_type, :white_space => @white_space}, :method => 'get') do %>
  <%= hidden_field_tag('rev_to', params[:rev_to]) if params[:rev_to] %>
  <p>
    <%= l(:label_view_diff) %>:
    <label><%= radio_button_tag 'type', 'inline', @diff_type != 'sbs', :onchange => "this.form.submit()" %> <%= l(:label_diff_inline) %></label>
    <label><%= radio_button_tag 'type', 'sbs', @diff_type == 'sbs', :onchange => "this.form.submit()" %> <%= l(:label_diff_side_by_side) %></label>
    <label><%= radio_button_tag 'white_space', '0', @white_space == '0', :onchange => "this.form.submit()" %> show ws </label>
    <label><%= radio_button_tag 'white_space', '1', @white_space == '1', :onchange => "this.form.submit()" %> ignore ws </label>
    <%= text_field_tag 'context_lines', @context_lines, :size => 3 %>
  </p>
<% end %>

<% cache(@cache_key) do -%>
<%= render :partial => 'common/diff', :locals => {:diff => @diff, :diff_type => @diff_type, :diff_style => @repository.class.scm_name} %>
<% end -%>

<% other_formats_links do |f| %>
  <%= f.link_to 'Diff', :url => params, :caption => 'Unified diff' %>
<% end %>

<% html_title(with_leading_slash(@path), 'Diff') -%>

<% content_for :header_tags do %>
<%= stylesheet_link_tag "scm" %>
<% end %>
